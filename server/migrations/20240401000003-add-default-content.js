'use strict';

module.exports = {
  async up(queryInterface, Sequelize) {
    // Проверяем существование страниц перед вставкой
    const existingPages = await queryInterface.sequelize.query(
      "SELECT page_key FROM content_pages WHERE page_key IN ('about_us', 'delivery', 'payment', 'warranty')",
      { type: Sequelize.QueryTypes.SELECT }
    );
    
    // Создаем массив ключей страниц, которые уже существуют
    const existingKeys = existingPages.map(page => page.page_key);
    
    // Формируем массив данных только для тех страниц, которых еще нет
    const pagesToInsert = [
      {
        page_key: 'about_us',
        title: 'О нас',
        content: `
          <p>«ДОМУ МЕБЕЛЬ» — ведущий дистрибьютор премиальной мебели, предлагающий эксклюзивные коллекции от лучших Российских производителей. Мы тщательно отбираем предметы интерьера, сочетающие в себе безупречное качество, элегантный дизайн и функциональность, чтобы создать пространства, отражающие ваш стиль и статус.</p>
          
          <p>Наша миссия — обеспечивать клиентов мебелью премиум-класса, которая превращает дом в место настоящего комфорта и роскоши. Мы работаем с дизайнерами, архитекторами и частными заказчиками, предлагая индивидуальный подход и профессиональные решения для любых интерьерных задач.</p>
          
          <h4>Почему выбирают нас?</h4>
          <ul>
            <li>Высокое качество материалов</li>
            <li>Широкий ассортимент: от классики до современных трендов</li>
            <li>Персональный сервис и помощь в подборе мебели</li>
            <li>Гарантия на всю продукцию</li>
          </ul>
        `,
        meta_title: 'О компании ДОМУ МЕБЕЛЬ - премиальная мебель в Благовещенске',
        meta_description: 'ДОМУ МЕБЕЛЬ - ведущий дистрибьютор премиальной мебели в Благовещенске. Эксклюзивные коллекции от лучших российских производителей.',
        is_active: true,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        page_key: 'delivery',
        title: 'Доставка',
        content: `
          <h4>Условия доставки</h4>
          <p>Мы осуществляем доставку по всей России.</p>
          <ul>
            <li>Доставка по Благовещенску - бесплатно при заказе от 10 000 руб</li>
            <li>Доставка по Амурской области - от 1 000 руб</li>
            <li>Доставка в регионы - по тарифам транспортных компаний</li>
          </ul>
          <p>Сроки доставки: 1-3 дня по Благовещенску, 3-7 дней по Амурской области.</p>
          <p>Для уточнения деталей доставки, свяжитесь с нами по телефону.</p>
        `,
        meta_title: 'Доставка мебели по Благовещенску и России - ДОМУ МЕБЕЛЬ',
        meta_description: 'Условия доставки мебели от ДОМУ МЕБЕЛЬ. Бесплатная доставка по Благовещенску, доставка по всей России.',
        is_active: true,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        page_key: 'payment',
        title: 'Оплата',
        content: `
          <h4>Способы оплаты</h4>
          <p>Мы предлагаем удобные способы оплаты:</p>
          <ul>
            <li>Наличными при получении</li>
            <li>Банковской картой</li>
            <li>Безналичный расчет для юридических лиц</li>
            <li>Перевод на расчетный счет</li>
          </ul>
          <p>Все способы оплаты безопасны и защищены.</p>
        `,
        meta_title: 'Способы оплаты - ДОМУ МЕБЕЛЬ',
        meta_description: 'Удобные способы оплаты мебели в ДОМУ МЕБЕЛЬ. Наличные, банковские карты, безналичный расчет.',
        is_active: true,
        created_at: new Date(),
        updated_at: new Date()
      },
      {
        page_key: 'warranty',
        title: 'Гарантия',
        content: `
          <h4>Гарантийные обязательства</h4>
          <p>На всю мебель предоставляется официальная гарантия производителя.</p>
          <ul>
            <li>Гарантия на корпусную мебель - от 12 месяцев</li>
            <li>Гарантия на мягкую мебель - от 18 месяцев</li>
            <li>Расширенная гарантия на премиальные коллекции</li>
          </ul>
          <p>Мы обеспечиваем полное гарантийное обслуживание в течение всего срока гарантии.</p>
        `,
        meta_title: 'Гарантия на мебель - ДОМУ МЕБЕЛЬ',
        meta_description: 'Официальная гарантия на всю мебель от ДОМУ МЕБЕЛЬ. Гарантийное обслуживание, условия гарантии.',
        is_active: true,
        created_at: new Date(),
        updated_at: new Date()
      }
    ].filter(page => !existingKeys.includes(page.page_key));
    
    // Если есть страницы для вставки, выполняем операцию
    if (pagesToInsert.length > 0) {
      await queryInterface.bulkInsert('content_pages', pagesToInsert, {});
    }
  },

  async down(queryInterface, Sequelize) {
    await queryInterface.bulkDelete('content_pages', {
      page_key: ['about_us', 'delivery', 'payment', 'warranty']
    }, {});
  }
}; 